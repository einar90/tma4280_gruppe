% -*- root: ../ex6.tex -*-

\section{Theory} % (fold)

\subsection{Discretizing the Poisson problem}
\label{sec:discretizing_the_poisson_problem}
Considering the solution of the two-dimensional Poisson problem:
\begin{align}
  - \nabla u &= f \;\;\; \text{in } \Omega = (0,1) \times (0,1) \label{eq:poisson2d} \\
  u &= 0 \;\;\; \text{on } \partial \Omega \label{eq:poisson2d_edge}
\end{align}
Expanding equation \eqref{eq:poisson2d}:
\begin{equation}
  -u_{xx} - u_{yy} = f(x,y) \label{eq:poisson2d_expanded}
\end{equation}
Discretizing equation \eqref{eq:poisson2d_expanded} using a mesh like the one illustrated in Figure~\ref{fig:mesh} standard 5-point stencil illustrated in Figure~\ref{fig:stencil}:
\begin{equation}
  \nonumber
  - \frac{u_{i-1,j} - 2u_{i,j} + u_{i+1,j}}{h^2} - \frac{u_{i,j-1} - 2u_{i,j} + u_{i,j+1}}{h^2} = f_{i,j}
\end{equation}
\begin{equation}
  -u_{i-1,j} -u_{i,j-1} + 4u_{i,j} - u_{i+1,j} - u_{i,j+1} = h^2 \cdot f_{i,j}
\end{equation}
This equation, combined with a numbering scheme like the one illustrated in Figure~\ref{fig:numbering_scheme} gives us a penta-diagonal matrix equation $\mathbf{Au}=h^2\mathbf{f}$ :
% \begin{equation}
%   \begin{bmatrix}
%     4      & -1 & 0      & \cdots & -1     & 0      & \cdots & 0      & 0      & 0 \\
%     -1     & 4  & -1     & 0      & \cdots & -1     & 0      & \cdots & 0      & 0 \\
%     0      & -1 & 4      & -1     & 0      & \cdots & -1     & 0      & \cdots & 0 \\
%     \vdots & \ddots & -1     & 4      & -1     & -1     & \cdots & 0      & 0      & 0 \\
%            &   & 0       & \ddots & \ddots & 0      &        &        & -1     &   \\
%     0      &   & \cdots  &  0     & 0      &  0     &  -1    & -1     & 4      &
%   \end{bmatrix}
%   \times
%   \begin{bmatrix}
%     u_0 \\ u_1 \\ u_2 \\ \vdots \\ u_{n-1} \\ u_n
%   \end{bmatrix}
%   =
%   h^2 \cdot
%   \begin{bmatrix}
%     f_0 \\ f_1 \\ f_2 \\ \vdots \\ f_{n-1} \\ f_n
%   \end{bmatrix}
% \end{equation}

\begin{equation}
  \begin{bmatrix}
    4 & -1      & & & & & & & 0 \\
    -1 & 4 & \ddots &      & & & & & \vdots \\
    0 & \ddots      & 4 & & & & & & 0 \\
    \vdots & \ddots & & 4 & & & & & -1 \\
    0 & \ddots      & & & 4 & & & & 0 \\
    -1 & \ddots     & & & & 4 & & & \vdots \\
    0 & \ddots      & & & & & 4 & & \\
    \vdots & \ddots & & & & & & 4 & -1 \\
    0 & \ddots      & & & & & & & 4 \\
  \end{bmatrix}
  \times
  \begin{bmatrix}
    u_0 \\ u_1 \\ u_2 \\ \vdots \\ u_{n-1} \\ u_n
  \end{bmatrix}
  =
  h^2 \cdot
  \begin{bmatrix}
    f_0 \\ f_1 \\ f_2 \\ \vdots \\ f_{n-1} \\ f_n
  \end{bmatrix}
\end{equation}

... which may be solved in a number of ways.

\subsection{Equation solvers}
We will look at \emph{direct} and \emph{indirect} solvers for linear systems. A direct solver finds an exact solution in finite time, whereas an indirect solver \emph{iterates} on a solution until the error is acceptable.

\subsubsection{Direct solvers}
\paragraph*{Gauss-Jacobi} is a simple, direct method for any linear system $\mathbf{A}\mathbf{x} = \mathbf{b}$ which uses row reduction. It is often used in hand calculations. It is prone to roundoff errors, and there is no way to reuse the computations for different $\mathbf{b}$s. 

\paragraph*{LU-factorization} is better suited for computational use than Gauss-Jacobi. The first step is to factorize the matrix into a lower triangular part $\mathbf{L}$ and an upper triangular part $\mathbf{U}$:

\begin{equation}
  \mathbf{A} = \mathbf{L} \mathbf{U}.
\end{equation}

We can then solve the system using the substitution $\mathbf{z} = \mathbf{U} \mathbf{x}$

\begin{align}
  \mathbf{A} \mathbf{x} = \mathbf{L} &\mathbf{U} \mathbf{x} = \mathbf{b} \\
  \mathbf{L} &\mathbf{z} = \mathbf{b}.
\end{align}

We then find $\mathbf{z} = \mathbf{L}^{-1} \mathbf{b}$, then $\mathbf{x} = \mathbf{U}^{-1} \mathbf{z}$. These are cheap operations compared to $\mathbf{A} = \mathbf{L} \mathbf{U}$, which may be reused.

\subsubsection{Indirect solvers}

\begin{figure}[htbp]
  \centering
  \includegraphics{illustrations/mesh.pdf}
  \caption{An illustration of a general two-dimensional mesh.}
  \label{fig:mesh}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[]{illustrations/stencils.pdf}
  \caption{Illustration of the standard 5-point stencil.}
  \label{fig:stencil}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics{illustrations/equation_numbering.pdf}
  \caption{The numbering scheme used.}
  \label{fig:numbering_scheme}
\end{figure}


% section discretizing_the_poisson_problem (end)
